<div flow-init="{singleFile:true}"
     flow-file-added="!!{png:1,gif:1,jpg:1,jpeg:1}[$file.getExtension()]"
     flow-files-submitted="$flow.upload()" flow-file-progress="updateProgress($file)"
     flow-file-added="setImage(null)"
     flow-file-success="setImage($message)">
<div class="introduction fader" ng-hide="$flow.files.length" >
    {{ 'INTRODUCTION' | translate }}. {{ 'INTRODUCTION_TRYIT' | translate }} <a target="_blank" download="1773007-005324400804.jpg"
                                         href="img/forms/1773007-005324400804.jpg">{{
    'INTRODUCTION_TRYIT_LINK' | translate }}</a>!
</div>
<div class="block column"
     ng-class="{success : hasUploadFinished(), done: hasExtractionFinished()}">

    <h3>{{ 'UPLOAD_TITLE' | translate }}</h3>

    <div>
        <img ng-src="{{uploadUrl}}" class="thumbnail"
             ng-hide="(hasUploadFinished() && hasRegistrationFailed())"/>
        <img class="thumbnail" flow-img="$flow.files[0]"
             ng-show="(hasUploadFinished() && hasRegistrationFailed())"/>

        <div class="progress progress-striped"
             ng-class="{active: $flow.file.isUploading()}"
             ng-show="$flow.files.length && !hasUploadFinished()">
            <div class="progress-bar" role="progressbar"
                 ng-style="{width: (progress * 100) + '%'}">
                <span class="sr-only">{{Math.round(progress * 100) }}% Lengkap</span>
            </div>
        </div>
    </div>
    <div>
            <span class="btn btn-primary" ng-hide="$flow.files.length" flow-btn
                  flow-attrs="{accept:'image/*'}">{{ 'UPLOAD_BUTTON' | translate }}</span>
    </div>
</div>
<div class="block column"
     ng-class="{success : hasExtractionSucceeded(), failure : hasExtractionFailed(), done: mostProbableOutcome}">
    <h3>{{ 'DETECTION_TITLE' | translate }}</h3>

    <div class="result numbers"
         ng-show="(hasUploadFinished() && !hasRegistrationFailed())">
        <div ng-repeat="extractedImage in extractedImages" style="padding: 2px; float: left"
             ng-show="$flow.files.length">
            <img src="{{extractedImage.filename}}"/>
        </div>
    </div>
    <div class="result" ng-show="(hasUploadFinished() && hasRegistrationFailed())">
        <p>
            {{ 'UPLOAD_ERROR_EXCUSE' | translate }} <br/>
            {{ 'UPLOAD_ERROR_DIAGNOSIS' | translate }} <br/>
            {{ 'UPLOAD_ERROR_SUGGESTION' | translate }}
        </p>

    </div>
    <div>
        <a href="#" class="btn btn-danger"
           ng-show="(hasUploadFinished() && hasRegistrationFailed())" ng-click="abort()">
            {{ 'UPLOAD_CANCEL' | translate }}
        </a>
    </div>
</div>
<div class="block column"
     ng-class="{success : mostProbableOutcome, failure : ((correction && !submitted) || (!numbersAddUp() && !submitted)), done: (correction || correct)}">
    <h3>{{ 'VERIFICATION_TITLE' | translate }}</h3>

    <div ng-show="mostProbableOutcome" class="result">
        <table class="hasil">
            <tr>
                <th>
                    {{'FORM_CANDIDATE'| translate }}
                </th>
                <th>
                    {{'FORM_TOTAL'| translate }}
                </th>
            </tr>
            <tr>
                <td>
                    H. Prabowo Subianto
                </td>
                <td>
                    {{ mostProbableOutcome.prabowo }}
                </td>
            </tr>
            <tr>
                <td>
                    Ir. H. Joko Widodo
                </td>
                <td>
                    {{ mostProbableOutcome.jokowi }}
                </td>
            </tr>
            <tr>
                <td>
                    {{'FORM_VOTES_VALID'| translate }}
                </td>
                <td class="jumlah" ng-class="{warning : !numbersAddUp() }">
                    {{ mostProbableOutcome.total }}
                </td>
            </tr>
            <tr>
                <td>
                    {{ 'FORM_VOTES_INVALID' | translate}}
                </td>
                <td>
                    {{ mostProbableOutcome.invalid }}
                </td>
            </tr>

            <tr>
                <td colspan="2" class="warning">
                    <b>{{ 'SAMPLE_WARNING' | translate }}</b>
                    {{ 'SAMPLE_MESSAGE' | translate }}

                </td>
            </tr>
        </table>
        <table class="hasil tandaTangan">
            <tr>
                <th colspan="2">
                    {{ 'WITHNESS_SIGNATURES' | translate }}
                </th>
            </tr>
            <tr>
                <td>
                    H. Prabowo Subianto
                </td>
                <td>
                    <span class="okay" tooltip-html-unsafe="{{getToolTip(signatures[0])}}"
                          ng-show="signatures[0].isValid">Ada</span>
                    <span class="warning" tooltip-html-unsafe="{{getToolTip(signatures[0])}}"
                          ng-show="!signatures[0].isValid">Absen</span>
                </td>
            </tr>
            <tr>
                <td>
                    Ir. H. Joko Widodo
                </td>
                <td>
                    <span class="okay" tooltip-html-unsafe="{{getToolTip(signatures[1])}}"
                          ng-show="signatures[1].isValid">Ada</span>
                    <span class="warning" tooltip-html-unsafe="{{getToolTip(signatures[1])}}"
                          ng-show="!signatures[1].isValid">Absen</span>
                </td>
            </tr>
        </table>
    </div>
    <div>
            <span class="btn btn-success"
                  ng-show="mostProbableOutcome && !correction && !correct && numbersAddUp()"
                  ng-click="agree()">
                {{ 'BUTTON_CORRECT' | translate }}
            </span>
            <span class="btn btn-danger"
                  ng-show="mostProbableOutcome && !correction && !correct"
                  ng-click="disagree()">
                {{ 'BUTTON_NOT_CORRECT' | translate }}
            </span>
    </div>
</div>
<div class="block column" ng-class="{success : submitted}">
    <form name="submitForm">
        <h3>{{ 'CORRECTION_TITLE' | translate }}</h3>

        <div ng-show="correction || correct" class="result">
            <table class="hasil">
                <tr>
                    <th>
                        {{'FORM_CANDIDATE'| translate}}
                    </th>
                    <th>
                        {{'FORM_TOTAL'| translate}}
                    </th>
                </tr>
                <tr>
                    <td>
                        H. Prabowo Subianto
                    </td>
                    <td>
                        <input ng-model="correction.prabowo" type="number" max="999"
                               ng-maxlength="3" ng-show="correction && !submitted"/>
                        <span ng-show="correction && submitted">{{correction.prabowo}}</span>
                        <span ng-show="correct">{{mostProbableOutcome.prabowo}}</span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Ir. H. Joko Widodo
                    </td>
                    <td>
                        <input ng-model="correction.jokowi" type="number" max="999" ng-maxlength="3"
                               ng-show="correction && !submitted"/>
                        <span ng-show="correction && submitted">{{correction.jokowi}}</span>
                        <span ng-show="correct">{{mostProbableOutcome.jokowi}}</span>
                    </td>
                </tr>
                <tr>
                    <td>
                        {{'FORM_VOTES_VALID'| translate}}
                    </td>
                    <td class="jumlah">
                        <span ng-show="correction">{{ correction.prabowo +  correction.jokowi}}</span>
                        <span ng-show="correct">{{ mostProbableOutcome.total }}</span>
                    </td>
                </tr>
                <tr>
                    <td>
                        {{'FORM_VOTES_INVALID'|translate}}
                    </td>
                    <td>
                        <input ng-model="correction.invalid" type="number" max="999"
                               ng-maxlength="3"
                               ng-show="correction && !submitted"/>
                        <span ng-show="correction && submitted">{{correction.invalid}}</span>
                        <span ng-show="correct">{{mostProbableOutcome.invalid}}</span>
                    </td>
                </tr>
            </table>
            <div ng-show="submitted" class="beritaBerhasil">
                <b>{{ 'SUBMITTED_THANKS' | translate }}</b> {{ 'SUBMITTED_MESSAGE' | translate }}
            </div>
        </div>
        <div>
            <span class="btn btn-success" ng-disabled="submitForm.$invalid"
                  ng-show="(correction && !submitted) || (correct && !submitted)"
                  ng-click="submit()">
                {{ 'BUTTON_SEND' | translate }}
            </span>

            <div>
                <a href="#" class="btn btn-success" ng-show="submitted" ng-click="abort()">
                    {{ 'BUTTON_RESTART' | translate }}
                </a>
            </div>
        </div>
    </form>
</div>
<a class="bottomright" href="contoh-formulir.zip">{{ 'LINK_DOWNLOAD_FORMS' | translate }}</a>
</div>